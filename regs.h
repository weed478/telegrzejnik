#ifndef MYKERNEL_REGS_H
#define MYKERNEL_REGS_H

#include "defs.h"

typedef u32 reg_addr_t;

enum
{
    // BCM2836
    // PERIPHERAL_BASE = 0x3f000000,
    // BCM2711
    PERIPHERAL_BASE = 0xfe000000,
    
    // GPIO

    GPIO_BASE = PERIPHERAL_BASE + 0x200000,

    GPIO_GPFSEL0 = GPIO_BASE + 0x00,
    GPIO_GPFSEL1 = GPIO_BASE + 0x04,
    GPIO_GPFSEL2 = GPIO_BASE + 0x08,
    GPIO_GPFSEL3 = GPIO_BASE + 0x0c,
    GPIO_GPFSEL4 = GPIO_BASE + 0x10,
    GPIO_GPFSEL5 = GPIO_BASE + 0x14,
    
    GPIO_GPSET0 = GPIO_BASE + 0x1c,
    GPIO_GPSET1 = GPIO_BASE + 0x20,
    
    GPIO_GPCLR0 = GPIO_BASE + 0x28,
    GPIO_GPCLR1 = GPIO_BASE + 0x2c,

    GPIO_GPLEV0 = GPIO_BASE + 0x34,
    GPIO_GPLEV1 = GPIO_BASE + 0x38,

    GPIO_PUP_PDN_CNTRL_REG0 = GPIO_BASE + 0xe4,
    GPIO_PUP_PDN_CNTRL_REG1 = GPIO_BASE + 0xe8,
    GPIO_PUP_PDN_CNTRL_REG2 = GPIO_BASE + 0xec,
    GPIO_PUP_PDN_CNTRL_REG3 = GPIO_BASE + 0xf0,

    // System Timer

    SYSTEM_TIMER_BASE = PERIPHERAL_BASE + 0x003000,

    SYSTEM_TIMER_CS = SYSTEM_TIMER_BASE + 0x00,
    SYSTEM_TIMER_CLO = SYSTEM_TIMER_BASE + 0x04,
    SYSTEM_TIMER_CHI = SYSTEM_TIMER_BASE + 0x08,

    // PWM0

    PWM0_BASE = PERIPHERAL_BASE + 0x20c000,

    PWM0_CTL  = PWM0_BASE + 0x00,
    PWM0_STA  = PWM0_BASE + 0x04,
    PWM0_DMAC = PWM0_BASE + 0x08,
    PWM0_RNG1 = PWM0_BASE + 0x10,
    PWM0_DAT1 = PWM0_BASE + 0x14,
    PWM0_FIF1 = PWM0_BASE + 0x18,
    PWM0_RNG2 = PWM0_BASE + 0x20,
    PWM0_DAT2 = PWM0_BASE + 0x24,

    // PWM1

    PWM1_BASE = PERIPHERAL_BASE + 0x20c800,

    PWM1_CTL  = PWM1_BASE + 0x00,
    PWM1_STA  = PWM1_BASE + 0x04,
    PWM1_DMAC = PWM1_BASE + 0x08,
    PWM1_RNG1 = PWM1_BASE + 0x10,
    PWM1_DAT1 = PWM1_BASE + 0x14,
    PWM1_FIF1 = PWM1_BASE + 0x18,
    PWM1_RNG2 = PWM1_BASE + 0x20,
    PWM1_DAT2 = PWM1_BASE + 0x24,

    // CM

    CM_BASE = PERIPHERAL_BASE + 0x101000,

    CM_PWMCTL = CM_BASE + 0xa0,
    CM_PWMDIV = CM_BASE + 0xa4,
};

#define REG(reg) (*(volatile uint*) (reg))

#endif
